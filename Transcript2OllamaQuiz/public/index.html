<!DOCTYPE html>
<html>
<head>
    <title>Quiz Generator</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 0 auto; padding: 20px; }
        textarea { width: 100%; height: 200px; }
        #quizOutput { margin-top: 20px; white-space: pre-wrap; }
        .progress { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Lecture Quiz Generator</h1>
    
    <div>
        <h2>Upload Lecture Transcript</h2>
        <input type="file" id="fileUpload">
    </div>
    
    <div>
        <button id="generateBtn">Generate Quiz</button>
        <div id="status"></div>
        <div id="progress" class="progress"></div>
    </div>
    
    <div id="quizOutput"></div>

    <script>
        document.getElementById('generateBtn').addEventListener('click', async function() {
            const file = document.getElementById('fileUpload').files[0];
            if (!file) {
                document.getElementById('status').textContent = "Please select a file";
                return;
            }
            
            const btn = this;
            btn.disabled = true;
            document.getElementById('status').textContent = "Processing...";
            document.getElementById('progress').textContent = "";
            document.getElementById('quizOutput').textContent = "";

            try {
                const transcript = await new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.readAsText(file);
                });

                // Show file size
                document.getElementById('progress').textContent = 
                    `Processing ${Math.round(transcript.length/1000)}k document...`;

                const response = await fetch('http://localhost:3000/api/generate-quiz', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ transcript })
                });

                const data = await response.json();
                document.getElementById('quizOutput').textContent = data.quiz;
                document.getElementById('status').textContent = "Quiz generated!";
                document.getElementById('progress').textContent = 
                    `Processed in ${data.processedChunks} chunks`;
                
            } catch (error) {
                document.getElementById('status').textContent = "Error generating quiz";
                document.getElementById('quizOutput').textContent = error.message;
            } finally {
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>